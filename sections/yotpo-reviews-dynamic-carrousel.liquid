{% comment %} {{ 'section-summer-reviews-2025.css' | asset_url | stylesheet_tag }} {% endcomment %}
{{ 'section-yotpo-reviews-dynamic.css' | asset_url | stylesheet_tag }}
{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{% comment %} {{ 'section-main-product.css' | asset_url | stylesheet_tag }} {% endcomment %}

{% style %}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{% endstyle %}

{% comment %}
  <style>
      .reviews-list-wrapper{
        display:block;
      }

      {% comment %} .reviews-list-wrapper .reviews-list__item{
        min-width:200px!important;
      } {% endcomment %}

      .reviews-list__item.no-image .review-section_text{
        justify-content:flex-start;
      }

      .product-popup-modal__content-info .heading-container > .h2{
        margin-top:0;
      }

      .content-container blockquote{
        width: 100%;
        margin: 0 auto;
      }

      @media screen and (min-width:990px){
        .content-container blockquote{
          width: 90%;
        }
      }

      modal-dialog.no-image .product-popup-modal__content-info {
        display: grid;
        grid-template-columns: 1fr; /* Single column */
        grid-template-rows: auto auto auto;
        grid-template-areas:
          "heading"
          "content"
          "additional";
        height: 100%;
      }

      .review-section_image{
        padding:0 2rem;
      }

      .review-section_image.circle img{
        object-position: top;
      }

      @media screen and (max-width:449px) {
        .review-title{
          font-size: 1.5rem;
        }

        .revie__content,
        .review-button{
          font-size: 1rem;
        }
      }

      .reviews-list{
        --grid-mobile-horizontal-spacing: 0px;
        --grid-desktop-horizontal-spacing: 0px;
      }

      .reviews-list__review-wrapper modal-opener{
        height:100%;
      }

      .image-container img {
        max-width: min(250px, 70%) !important;
      }

      .image-container > div{
        text-align:center;
      }

      .modal-opener__button{
        background:none;
        border:none;
        cursor:pointer;
        height:100%;
        display:flex;
        flex-direction:column;
      }

      .modal-opener__button:hover .review-button::before {
        transform: scaleX(1);
      }

      .modal-opener__button:hover .review-button::after {
        height: 2px;
        transform: scaleY(1);
      }

      @media screen and (max-width: 749px) {
        .grid--peek.slider.reviews-list .grid__item:first-of-type {
          margin-left: 0;
        }
      }

      .product-popup-modal__content-info {
        grid-template-areas:
          "heading   "
          "image     "
          "additional"
          "content   ";

        padding: 0 !important;
      }

      @media (min-width: 751px) {
        .product-popup-modal__content-info {
          grid-template-areas:
            "image    content  content   "
            "image   content    content   "
            "image heading  additional";
        }

        .image-container img {
          max-width: unset !important;
        }

        .product-popup-modal__content-info .heading-container > .h2{
          margin-bottom:0;
          font-size: 1.6rem;
          font-weight:700;
        }

        .content-container,
        .heading-container{
          padding: 0 0 0 3rem;
        }

        .content-container{
          display: flex;
          justify-content: center;
          align-items: center;
        }
      }

      .content-container p{
        text-align:center;
      }

      .additional-information{
        justify-content: center;
      }

      .image-container{
        align-items: center;
      }

      .image-container img{
        aspect-ratio: 1;
        border-radius: 50%;
        object-position: top;
      }

      .product-popup-modal .product-popup-modal__content {
        padding:0 1.5rem 1.5rem!important;
      }

    .reviews-loading {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 200px;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid rgba(0,0,0,0.1);
      border-top-color: rgba(0,0,0,0.6);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto;
      display:block!important;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
{% endcomment %}

{% assign product = all_products['tape-in-remy-human-hair-extension-darkest-brown-2'] %}

<div
  class="color-{{ section.settings.color_scheme }} gradient section-{{ section.id }}-padding {% if section.settings.trackable_name != blank %}trackable-section{% endif %}"
  {% if section.settings.trackable_name != blank %}
    id="{{ section.settings.trackable_name | handleize }}"
    data-section-name="{{ section.settings.trackable_name | handleize }}"
    data-section-instance="{{ section.id }}"
  {% else %}
    id="{{ section.id }}"
  {% endif %}
>
  {%- liquid
    assign columns_mobile_int = section.settings.columns_mobile | plus: 0
    assign show_mobile_slider = false
    if section.settings.swipe_on_mobile
      assign show_mobile_slider = true
    endif

    assign columns_desktop_int = section.settings.columns_desktop | plus: 0
    assign show_desktop_slider = false
    if section.settings.swipe_on_desktop
      assign show_desktop_slider = true
    endif

    assign columns_tablet = columns_desktop_int | plus: columns_mobile_int | divided_by: 2 | ceil
    if section.settings.swipe_on_desktop
      assign show_tablet_slider = true
    endif

    assign product_id = ''
    if template.name == 'product'
      assign product_id = product.id
    endif
  -%}

  <yotpo-dynamic-reviews
    data-product-id="{{ product_id }}"
    data-section-id="{{ section.id }}"
    class="reviews-list-wrapper page-width isolate no-heading no-mobile-link"
  >
    <div id="reviews-loading" class="reviews-loading">
      <div class="spinner"></div>
    </div>

    <slider-component
      data-visual="counter"
      class="slider-mobile-gutter{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
    >
      <ul
        class="reviews-list contains-card contains-card--collection{% if settings.card_style == 'standard' %} contains-card--standard{% endif %} grid grid--{{ section.settings.columns_desktop }}-col-desktop grid--{{ columns_tablet }}-col-tablet grid--{{ section.settings.columns_mobile }}-col-tablet-down{% if section.settings.swipe_on_mobile or section.settings.swipe_on_desktop %} slider grid--peek{% endif %}{% if section.settings.swipe_on_mobile %} slider--tablet{% endif %}{% if section.settings.swipe_on_desktop %} slider--desktop{% endif %} videos-list--{{ section.blocks.size }}-items slide-mobile-{{ show_mobile_slider }} slide-tablet-{{ show_tablet_slider }} slide-desktop-{{ show_desktop_slider }}"
        id="Slider-{{ section.id }}"
        role="list"
        {% if section.settings.trackable_name != blank %}
          data-horizontal-scroll
        {% endif %}
      >
        {%- liquid
          assign columns = section.blocks.size
          if columns > 3
            assign columns = 3
          endif
        -%}
      </ul>

      {%- if show_mobile_slider or show_tablet_slider or show_desktop_slider -%}
        <div class="slider-buttons slider-buttons-square no-js-hidden slider--{{ section.settings.columns_desktop }}-col-desktop slider--{{ section.settings.columns_mobile }}-col-tablet-down">
          <button
            type="button"
            class="slider-button slider-button--prev"
            name="previous"
            aria-label="{{ 'general.slider.previous_slide' | t }}"
          >
            {% render 'icon-caret' %}
          </button>

          <div class="slider-counter caption visually-hidden">
            <span class="slider-counter--current">1</span>
            <span aria-hidden="true"> / </span>
            <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
            <span class="slider-counter--total">{{ section.blocks.size }}</span>
          </div>
          <button
            type="button"
            class="slider-button slider-button--next"
            name="next"
            aria-label="{{ 'general.slider.next_slide' | t }}"
          >
            {% render 'icon-caret' %}
          </button>
        </div>
      {%- endif -%}
    </slider-component>

    <template id="base-review-template">
      <li
        id="Slide-{{ section.id }}-FORLOOP.INDEX"
        class="reviews-list__item grid__item custom__slide{% if show_mobile_slider or show_tablet_slider or show_desktop_slider %} slider__slide{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
        {% if settings.animations_reveal_on_scroll %}
          data-cascade
          style="--animation-order: FORLOOP.INDEX;"
        {% endif %}
      >
        {% render 'review-card-with-modal', section_id: section.id %}
      </li>
    </template>
  </yotpo-dynamic-reviews>
</div>

<script src="{{ 'yotpo-dynamic-modal.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Yotpo Reviews Carousel",
  "tag": "section",
  "class": "section section-reviews-list",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 3,
      "label": "Number of columns on desktop"
    },
    {
      "type": "checkbox",
      "id": "swipe_on_desktop",
      "default": false,
      "label": "Enable swipe on desktop"
    },

    {
      "type": "header",
      "content": "Mobile Layout"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "options": [
        {
          "value": "1",
          "label": "1 column"
        },
        {
          "value": "2",
          "label": "2 columns"
        },
        {
          "value": "3",
          "label": "3 columns"
        }
      ],
      "default": "1",
      "label": "Number of columns on mobile"
    },
    {
      "type": "checkbox",
      "id": "swipe_on_mobile",
      "default": false,
      "label": "Enable swipe on mobile"
    },
    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    },
    {
      "type": "header",
      "content": "Tracking information"
    },
    {
      "type": "text",
      "id": "trackable_name",
      "label": "Section Name (for analytics)"
    }
  ],
  "presets": [
    {
      "name": "Yotpo Reviews Carousel"
    }
  ]
}
{% endschema %}
